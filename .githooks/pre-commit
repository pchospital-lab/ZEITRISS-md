#!/bin/sh
files=$(git diff --cached --name-only --diff-filter=ACM | grep '\.md$')
if [ -n "$files" ]; then
    if grep -n "\s$" $files; then
        echo 'Error: trailing whitespace detected.' >&2
        exit 1
    fi
    long_lines=$(grep -nH '.\{121\}' $files)
    if [ -n "$long_lines" ]; then
        echo 'Error: lines longer than 120 characters:' >&2
        echo "$long_lines" >&2
        exit 1
    fi
fi

# validate module index
python3 scripts/validate_index.py || exit 1
python3 scripts/lint_hud_codex.py || exit 1

python3 scripts/lint_signal_devices.py || exit 1
