{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://zeitriss.example/saveGame.v6.schema.json",
  "title": "ZEITRISS Save v6",
  "type": "object",
  "additionalProperties": true,
  "required": [
    "save_version",
    "zr_version",
    "location",
    "phase",
    "campaign",
    "character",
    "team",
    "party",
    "loadout",
    "economy",
    "logs",
    "ui",
    "arena",
    "arc_dashboard"
  ],
  "properties": {
    "save_version": { "type": "integer", "const": 6 },
    "zr_version": { "type": "string" },
    "location": { "type": "string" },
    "phase": { "type": "string", "enum": ["core", "transfer", "rift", "pvp"] },
    "campaign": {
      "type": "object",
      "additionalProperties": true,
      "required": ["px", "exfil"],
      "properties": {
        "phase": { "type": "string", "enum": ["core", "transfer", "rift", "pvp"] },
        "episode": { "type": "integer" },
        "mission_in_episode": { "type": "integer" },
        "scene": { "type": ["integer", "null"] },
        "px": { "type": "integer", "minimum": 0, "maximum": 5 },
        "px_reset_pending": { "type": "boolean" },
        "px_reset_confirm": { "type": "boolean" },
        "px_reset_scheduled_at": { "type": ["string", "null"] },
        "fr_bias": { "type": "string" },
        "team_size": { "type": ["integer", "null"] },
        "boss_dr": { "type": "integer" },
        "compliance_shown_today": { "type": "boolean" },
        "exfil": {
          "type": "object",
          "required": ["active", "armed", "hot", "sweeps", "stress", "ttl", "anchor", "alt_anchor"],
          "properties": {
            "active": { "type": "boolean" },
            "armed": { "type": "boolean" },
            "hot": { "type": "boolean" },
            "sweeps": { "type": "integer" },
            "stress": { "type": "integer" },
            "ttl": { "type": "integer", "minimum": 0 },
            "anchor": { "type": ["string", "null"] },
            "alt_anchor": { "type": ["string", "null"] }
          }
        },
        "rift_seeds": { "type": "array", "items": { "type": "object" } }
      }
    },
    "character": {
      "type": "object",
      "additionalProperties": true,
      "required": ["id", "attributes", "stress", "psi_heat", "cooldowns"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "callsign": { "type": "string" },
        "rank": { "type": "string" },
        "lvl": { "type": ["integer", "number"] },
        "xp": { "type": ["integer", "number"] },
        "stress": { "type": "number" },
        "psi_heat": { "type": "number" },
        "psi_heat_max": { "type": ["integer", "number"] },
        "attributes": {
          "type": "object",
          "required": ["SYS_max", "SYS_installed", "SYS_runtime", "SYS_used"],
          "properties": {
            "SYS_max": { "type": "number" },
            "SYS_installed": { "type": "number" },
            "SYS_runtime": { "type": "number" },
            "SYS_used": { "type": "number" }
          }
        },
        "cooldowns": { "type": "object" },
        "modes": { "type": "array", "items": { "type": "string" } }
      }
    },
    "team": {
      "type": "object",
      "additionalProperties": true,
      "description": "Legacy/Migration: party.characters ist kanonisch.",
      "properties": {
        "name": { "type": "string" },
        "members": { "type": "array", "items": { "type": "object" } },
        "roster": { "type": "array", "items": { "type": "object" } }
      }
    },
    "party": {
      "type": "object",
      "additionalProperties": true,
      "required": ["characters"],
      "properties": {
        "characters": { "type": "array", "items": { "type": "object" } }
      }
    },
    "loadout": {
      "type": "object",
      "additionalProperties": true
    },
    "economy": {
      "type": "object",
      "required": ["wallets"],
      "properties": {
        "cu": { "type": ["integer", "number"] },
        "wallets": { "type": "object" }
      }
    },
    "logs": {
      "type": "object",
      "additionalProperties": true,
      "required": [
        "hud",
        "trace",
        "artifact_log",
        "market",
        "offline",
        "kodex",
        "alias_trace",
        "squad_radio",
        "foreshadow",
        "fr_interventions",
        "arena_psi",
        "psi",
        "flags"
      ],
      "properties": {
        "hud": { "type": "array", "items": { "type": ["object", "string"] } },
        "trace": { "type": "array", "items": { "type": ["object", "string"] } },
        "artifact_log": { "type": "array", "items": { "type": ["object", "string"] } },
        "market": { "type": "array", "items": { "type": ["object", "string"] } },
        "offline": { "type": "array", "items": { "type": ["object", "string"] } },
        "kodex": { "type": "array", "items": { "type": ["object", "string"] } },
        "alias_trace": { "type": "array", "items": { "type": ["object", "string"] } },
        "squad_radio": { "type": "array", "items": { "type": ["object", "string"] } },
        "field_notes": { "type": "array", "items": { "type": ["object", "string"] } },
        "foreshadow": { "type": "array", "items": { "type": ["object", "string"] } },
        "fr_interventions": { "type": "array", "items": { "type": ["object", "string"] } },
        "arena_psi": { "type": "array", "items": { "type": ["object", "string"] } },
        "psi": { "type": "array", "items": { "type": ["object", "string"] } },
        "flags": {
          "type": "object",
          "required": ["merge_conflicts"],
          "properties": {
            "merge_conflicts": { "type": "array", "items": { "type": "object" } },
            "platform_action_contract": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "action_mode": { "type": "string", "const": "uncut" }
              }
            }
          }
        }
      }
    },
    "ui": {
      "type": "object",
      "required": [
        "gm_style",
        "intro_seen",
        "suggest_mode",
        "action_mode"
      ],
      "properties": {
        "gm_style": { "type": "string" },
        "intro_seen": { "type": "boolean" },
        "suggest_mode": { "type": "boolean" },
        "action_mode": { "type": "string", "const": "uncut" },
        "contrast": { "type": "string", "enum": ["standard", "high"] },
        "badge_density": { "type": "string", "enum": ["standard", "dense", "compact"] },
        "output_pace": { "type": "string", "enum": ["normal", "fast", "slow"] },
        "voice_profile": {
          "type": "string",
          "enum": ["gm_third_person", "gm_observer"]
        }
      }
    },
    "arena": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "active": { "type": "boolean" },
        "phase": { "type": "string" },
        "mode": { "type": "string" },
        "previous_mode": { "type": ["string", "null"] },
        "wins_player": { "type": "integer" },
        "wins_opponent": { "type": "integer" },
        "tier": { "type": "integer" },
        "proc_budget": { "type": "integer" },
        "artifact_limit": { "type": "integer" },
        "loadout_budget": { "type": "integer" },
        "phase_strike_tax": { "type": "integer" },
        "damage_dampener": { "type": "boolean" },
        "queue_state": {
          "type": "string",
          "enum": ["idle", "searching", "matched", "staging", "active", "completed"]
        },
        "zone": { "type": "string", "enum": ["safe", "combat"] },
        "team_size": { "type": "integer", "minimum": 0, "maximum": 5 },
        "match_policy": { "type": "string", "enum": ["sim", "lore"] },
        "fee": { "type": "integer" },
        "scenario": { "type": ["object", "null"] },
        "started_episode": { "type": ["integer", "null"] },
        "last_reward_episode": { "type": ["integer", "null"] },
        "policy_players": { "type": "array", "items": { "type": "object" } },
        "audit": { "type": "array", "items": { "type": "object" } },
        "resume_token": { "type": ["string", "null"] }
      }
    },
    "arc_dashboard": {
      "type": "object",
      "additionalProperties": true,
      "required": ["offene_seeds", "fraktionen", "fragen", "timeline"],
      "properties": {
        "offene_seeds": {
          "type": "array",
          "items": { "type": ["object", "string"] }
        },
        "fraktionen": { "type": "object" },
        "fragen": { "type": "array", "items": { "type": ["object", "string"] } },
        "timeline": { "type": "array", "items": { "type": ["object", "string"] } }
      }
    }
  }
}
